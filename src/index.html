<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DRTM - Disaster Recovery Training Management</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.10.0/web3.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• Disaster Recovery Training Management</h1>
            <p>Blockchain-based Training Session Management System</p>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">Connection Status</span>
                <span class="status-value" id="connectionStatus">Disconnected</span>
            </div>
            <div class="status-item">
                <span class="status-label">Account</span>
                <span class="status-value" id="currentAccount">Not Connected</span>
            </div>
            <div class="status-item">
                <span class="status-label">Network</span>
                <span class="status-value" id="networkId">-</span>
            </div>
            <div class="status-item">
                <span class="status-label">User Type</span>
                <span class="status-value" id="userType">Unknown</span>
            </div>
            <button class="btn" id="connectWallet">Connect Wallet</button>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="showTab('registration')">Registration</button>
            <button class="tab-button" onclick="showTab('admin')">Admin Panel</button>
            <button class="tab-button" onclick="showTab('booking')">Book Training</button>
            <button class="tab-button" onclick="showTab('schedule')">View Schedule</button>
            <button class="tab-button" onclick="showTab('search')">Search & Statistics</button>
        </div>

        <div id="alerts"></div>

        <!-- Registration Tab -->
        <div id="registration" class="tab-content active">
            <h2>User Registration</h2>
            <div class="form-group">
                <label>Registration Type:</label>
                <select id="registrationType" onchange="toggleRegistrationForm()">
                    <option value="">Select Registration Type</option>
                    <option value="participant">Participant</option>
                    <option value="trainer">Trainer</option>
                </select>
            </div>

            <!-- Participant Registration Form -->
            <div id="participantForm" class="hidden">
                <h3>Participant Registration</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Name:</label>
                        <input type="text" id="partName" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label>Age:</label>
                        <input type="number" id="partAge" min="1" max="120" placeholder="Enter your age">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Gender:</label>
                        <select id="partGender">
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>District:</label>
                        <input type="text" id="partDistrict" placeholder="Enter your district">
                    </div>
                </div>
                <div class="form-group">
                    <label>Training Interest:</label>
                    <select id="partTrainingType">
                        <option value="">Select Training Type</option>
                        <option value="0">First Aid</option>
                        <option value="1">Shelter Rebuild</option>
                        <option value="2">Food Safety</option>
                    </select>
                </div>
                <button class="btn" onclick="registerParticipant()">Register as Participant</button>
            </div>

            <!-- Trainer Registration Form -->
            <div id="trainerForm" class="hidden">
                <h3>Trainer Registration</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Name:</label>
                        <input type="text" id="trainerName" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label>District:</label>
                        <input type="text" id="trainerDistrict" placeholder="Enter your district">
                    </div>
                </div>
                <button class="btn" onclick="registerTrainer()">Register as Trainer</button>
            </div>
        </div>

        <!-- Admin Panel Tab -->
        <div id="admin" class="tab-content">
            <h2>Admin Panel</h2>
            <div class="alert alert-info">
                <strong>Admin Only:</strong> Only registered admins can update participant data.
            </div>
            
            <div class="form-group">
                <label>Participant Address:</label>
                <input type="text" id="updatePartAddress" placeholder="0x...">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Update Training Type:</label>
                    <select id="updateTrainingType">
                        <option value="">Don't Update</option>
                        <option value="0">First Aid</option>
                        <option value="1">Shelter Rebuild</option>
                        <option value="2">Food Safety</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Mark Training Complete:</label>
                    <select id="markComplete">
                        <option value="">Don't Update</option>
                        <option value="true">Mark as Completed</option>
                    </select>
                </div>
            </div>
            
            <button class="btn" onclick="updateParticipant()">Update Participant</button>
            <button class="btn btn-success" onclick="loadParticipantData()">Load Participant Data</button>
            
            <div id="participantData" class="hidden">
                <h3>Current Participant Data</h3>
                <div id="participantInfo"></div>
            </div>
        </div>

        <!-- Booking Tab -->
        <div id="booking" class="tab-content">
            <h2>Book Training Slot</h2>
            <div class="alert alert-info">
                <strong>Note:</strong> Only registered participants can book training slots. Booking fee: <span id="bookingFeeDisplay">Loading...</span> ETH
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Select Trainer:</label>
                    <select id="bookingTrainer">
                        <option value="">Select a Trainer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Select Date:</label>
                    <input type="date" id="bookingDate">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Start Time:</label>
                    <select id="bookingStartTime">
                        <option value="">Select Start Time</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Admin to Pay:</label>
                    <select id="adminPayee">
                        <option value="">Select Admin</option>
                    </select>
                </div>
            </div>
            
            <button class="btn" onclick="checkAvailability()">Check Availability</button>
            <button class="btn btn-success" onclick="bookSlot()">Book Slot</button>
            
            <div id="availabilityResult"></div>
        </div>

        <!-- Schedule Tab -->
        <div id="schedule" class="tab-content">
            <h2>Training Schedule</h2>
            <div class="form-group">
                <label>Select Date to View:</label>
                <input type="date" id="scheduleDate">
                <button class="btn" onclick="loadSchedule()">Load Schedule</button>
            </div>
            
            <div id="scheduleDisplay" class="schedule-grid"></div>
        </div>

        <!-- Search & Statistics Tab -->
        <div id="search" class="tab-content">
            <h2>Search & Statistics</h2>
            
            <div class="search-section">
                <h3>Participants by District</h3>
                <button class="btn" onclick="loadDistrictStats()">Load District Statistics</button>
                <div id="districtStats" class="district-list"></div>
            </div>
            
            <div class="search-section">
                <h3>Search Participants</h3>
                <div class="form-group">
                    <label>Search by District:</label>
                    <input type="text" id="searchDistrict" placeholder="Enter district name">
                    <button class="btn" onclick="searchByDistrict()">Search</button>
                </div>
                <div id="searchResults"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/config.js"></script>
    <script src="js/wallet.js"></script>
    <script src="js/registration.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/booking.js"></script>
    <script src="js/schedule.js"></script>
    <script src="js/search.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/main.js"></script>
</body>
</html>